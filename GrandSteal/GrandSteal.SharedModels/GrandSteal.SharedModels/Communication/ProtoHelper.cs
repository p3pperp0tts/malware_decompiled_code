using System;
using System.Collections;
using System.Collections.Generic;
using ProtoBuf.Meta;

namespace GrandSteal.SharedModels.Communication
{
	// Token: 0x02000016 RID: 22
	public static class ProtoHelper
	{
		// Token: 0x060000F9 RID: 249 RVA: 0x00004008 File Offset: 0x00002208
		public static void PopulateTypes(Type t)
		{
			using (IEnumerator enumerator = RuntimeTypeModel.Default.GetTypes().GetEnumerator())
			{
				while (enumerator.MoveNext())
				{
					MetaType metaType;
					if ((metaType = (enumerator.Current as MetaType)) != null && metaType.Type == t)
					{
						return;
					}
				}
			}
			Type typeFromHandle = typeof(object);
			List<Type> list = new List<Type>();
			do
			{
				list.Insert(0, t);
				t = t.BaseType;
				if (t == null)
				{
					break;
				}
			}
			while (t != typeFromHandle);
			int i = 0;
			while (i < list.Count - 1)
			{
				Type type = list[i];
				MetaType metaType2 = null;
				bool flag = false;
				RuntimeTypeModel expr_A3 = RuntimeTypeModel.Default;
				using (IEnumerator enumerator = ((expr_A3 != null) ? expr_A3.GetTypes() : null).GetEnumerator())
				{
					while (enumerator.MoveNext())
					{
						MetaType metaType3 = (MetaType)enumerator.Current;
						if (metaType3.Name.Equals(type.Name))
						{
							flag = true;
							metaType2 = metaType3;
							break;
						}
					}
					goto IL_142;
				}
				goto IL_101;
				IL_117:
				metaType2.AddSubType((metaType2.GetSubtypes().Length + 1) * 100, list[i + 1]);
				i++;
				continue;
				IL_101:
				RuntimeTypeModel expr_106 = RuntimeTypeModel.Default;
				metaType2 = ((expr_106 != null) ? expr_106.Add(type, true) : null);
				goto IL_117;
				IL_142:
				if (!flag)
				{
					goto IL_101;
				}
				goto IL_117;
			}
		}
	}
}
